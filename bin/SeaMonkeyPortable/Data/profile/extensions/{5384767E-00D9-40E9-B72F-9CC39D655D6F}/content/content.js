(function(){function e(){if(content.location.href.match(/.*synchronize.*/)){content.document.body.style.cursor="default";for(var a=content.document.getElementsByTagName("a"),b=0;b<a.length;b++)a[b].style.cursor="pointer"}}function f(){if(content.location.href.match(/.*synchronize.*/)){content.document.body.style.cursor="wait";for(var a=content.document.getElementsByTagName("a"),b=0;b<a.length;b++)a[b].style.cursor="wait"}}function g(a){if(content.location.href.match(/.*synchronize.*/)){a=String(a.json.text);
var b=content.document.getElementById("message");b.innerHTML=0<a.length?b.innerHTML+"<br>"+a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}}function h(){function a(){}var b=Components.manager.QueryInterface(c.nsIComponentRegistrar);a.prototype={classID:Components.ID("be85f49c-68b4-4c67-a611-97061d60a09c"),classDescription:"about:epubreader",contractID:"@mozilla.org/network/protocol/about;1?what=epubreader",QueryInterface:XPCOMUtils.generateQI([c.nsIAboutModule]),
newChannel:function(a){var b=k["@mozilla.org/network/io-service;1"].getService(c.nsIIOService).newChannel("chrome://epubreader/content/reader.xul",null,null);b.originalURI=a;return b},getURIFlags:function(){return c.nsIAboutModule.URI_SAFE_FOR_UNTRUSTED_CONTENT|c.nsIAboutModule.ALLOW_SCRIPT}};var d={createInstance:function(b){if(b)throw l.NS_ERROR_NO_AGGREGATION;return new a}};!1==b.isContractIDRegistered(a.prototype.contractID)&&b.registerFactory(a.prototype.classID,a.prototype.classDescription,
a.prototype.contractID,d);a.newChannel=a.newChannel;a.getURIFlags=a.getURIFlags}var d=Components.utils,k=Components.classes,c=Components.interfaces,l=Components.results;d.import("resource://gre/modules/Services.jsm");d.import("resource://gre/modules/XPCOMUtils.jsm");var m=Services.appinfo.processType===Services.appinfo.PROCESS_TYPE_CONTENT;addMessageListener("Epubreader:Sync:showProgress",g);addMessageListener("Epubreader:Sync:setWaitStatus",f);addMessageListener("Epubreader:Sync:setDefaultStatus",
e);h();m&&(d.import("chrome://epubreader/content/EpubreaderRegistrar.jsm"),EpubreaderRegistrar.register())})();
